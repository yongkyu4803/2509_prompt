import dotenv from 'dotenv';
import path from 'path';

// .env.local 파일 로드
dotenv.config({ path: path.join(process.cwd(), '.env.local') });

import { PromptService } from '../src/lib/database';

// Chapter 2 기반 프롬프트 3개
const CHAPTER2_PROMPTS = [
  {
    title: '다단계 문서 요약 시스템',
    description: '방대한 국정감사 자료를 초벌-정밀-핵심의 3단계로 체계적으로 요약하여 핵심 쟁점을 도출하는 전문 도구',
    content: `# 다단계 문서 요약 시스템

**역할**: 당신은 방대한 자료를 효율적으로 처리하는 전문 분석가입니다. 국정감사 자료를 체계적으로 요약하여 핵심 정보만을 추출합니다.

## 📋 기본 설정

**요약할 문서**: [문서 업로드 또는 텍스트 입력]

**문서 유형**: 
- [ ] 정책 보고서 
- [ ] 예산 관련 자료
- [ ] 감사원 지적사항
- [ ] 국정감사 답변서
- [ ] 언론 보도자료
- [ ] 기타: [직접 입력]

**요약 목적**:
- [ ] 질의서 작성 준비
- [ ] 현황 파악
- [ ] 문제점 도출
- [ ] 정책 분석
- [ ] 기타: [직접 입력]

**긴급도**: 
- [ ] 즉시 (핵심만 빠르게)
- [ ] 일반 (체계적 요약)
- [ ] 정밀 (상세 분석)

## 1단계: 초벌 요약 (문서 전체 파악)

### 📊 기본 문서 정보
- **문서명**: [제목 추출]
- **발행기관**: [작성 기관/부처]
- **발행일자**: [날짜]
- **페이지 수**: [총 페이지]
- **문서 성격**: [보고서/답변서/자료집 등]

### 🎯 핵심 내용 개괄 (3-5문장)
[문서의 전체적인 내용을 간단히 요약]

### 📌 주요 구성 요소
1. **주제 영역**: [다루는 정책/사업 분야]
2. **핵심 수치**: [중요한 예산, 성과지표, 통계]
3. **이해관계자**: [관련 기관,대상 집단]
4. **시간적 범위**: [다루는 기간]

## 2단계: 정밀 요약 (쟁점별 심화 분석)

### A. 주요 정책/사업별 분석

**[정책/사업명 1]**
- **목적**: [정책 목표]
- **내용**: [주요 추진 내용]
- **예산**: [관련 예산 규모]
- **성과**: [달성 성과 또는 진행 상황]
- **문제점**: [드러난 문제나 한계]

**[정책/사업명 2]**
[동일 형식으로 분석]

**[정책/사업명 3]**
[동일 형식으로 분석]

### B. 핵심 수치 및 통계 정리

| 구분 | 계획 | 실행 | 달성률 | 특이사항 |
|------|------|------|--------|----------|
| [항목1] | [수치] | [수치] | [%] | [특이점] |
| [항목2] | [수치] | [수치] | [%] | [특이점] |
| [항목3] | [수치] | [수치] | [%] | [특이점] |

### C. 문제점 및 개선사항

**🚨 즉시 검토 필요 사항**
1. [심각한 문제점이나 법령 위반 소지]
2. [예산 낭비나 비효율적 집행]
3. [정책 목표 대비 현저한 성과 미달]

**⚠️ 개선 검토 사항**
1. [효율성 개선이 필요한 분야]
2. [제도 개선이 필요한 영역]
3. [타 기관과의 조정이 필요한 사항]

**ℹ️ 참고 사항**
1. [일반적인 현황 정보]
2. [향후 계획]
3. [기타 참고할 만한 내용]

## 3단계: 핵심 요약 (국감 질의 포인트 도출)

### 🎯 TOP 3 질의 포인트

**1순위: [핵심 쟁점 제목]**
- **문제점**: [구체적 문제 상황]
- **근거자료**: [해당 페이지나 수치]
- **질의 방향**: [어떤 관점에서 질문할지]
- **예상 질문**: "○○에 대해 ○○한 문제가 있는데, 이에 대한 해명을 바랍니다."

**2순위: [핵심 쟁점 제목]**
- **문제점**: [구체적 문제 상황]
- **근거자료**: [해당 페이지나 수치]
- **질의 방향**: [어떤 관점에서 질문할지]
- **예상 질문**: [질문 예시]

**3순위: [핵심 쟁점 제목]**
- **문제점**: [구체적 문제 상황]
- **근거자료**: [해당 페이지나 수치]
- **질의 방향**: [어떤 관점에서 질문할지]  
- **예상 질문**: [질문 예시]

### 📋 추가 검토 사항 (4-10순위)
- [간단한 쟁점 목록과 핵심 포인트]

### 🔍 팩트체크 필요 항목
- **수치 검증**: [의심스러운 통계나 계산]
- **법령 확인**: [법적 근거가 필요한 사항]
- **타 기관 자료**: [교차 확인이 필요한 내용]

## 4단계: 후속 조치 가이드

### 📎 추가 요구 자료 목록
1. **필수**: [반드시 확보해야 할 상세 자료]
2. **우선**: [있으면 좋을 보완 자료]
3. **참고**: [추가 검토용 자료]

### 🔗 연관 검토 사항
- **관련 법령**: [확인해야 할 법률/시행령]
- **타 부처 연관성**: [협조나 확인이 필요한 타 기관]
- **과거 지적사항**: [감사원이나 국감에서 기 지적된 유사 사안]

### 📅 질의서 작성 전략
- **배경 설명**: [상황 설명에 활용할 내용]
- **핵심 공격포인트**: [집중 질의할 부분]
- **대안 제시**: [건설적 개선 방안]

---

## 🎛️ 사용자 맞춤 설정

**요약 스타일 선택**:
- [ ] 간결형: 핵심만 bullet point로
- [ ] 상세형: 맥락과 배경 포함
- [ ] 질의형: 질문 중심으로 구성
- [ ] 분석형: 문제점과 대안 중심

**출력 형식 선택**:
- [ ] 텍스트 요약문
- [ ] 표와 차트 중심  
- [ ] 질의서 초안 형태
- [ ] PPT 슬라이드 구성안

---

**사용 가이드**:
1. 문서를 업로드하거나 텍스트를 입력하고 기본 설정을 선택하세요
2. AI가 3단계에 걸쳐 체계적으로 요약을 진행합니다
3. 각 단계별 결과를 검토하고 필요시 심화 분석을 요청하세요
4. 최종 핵심 요약을 바탕으로 국정감사 전략을 수립하세요`,
    category: 'analysis',
    usageHours: 0,
    isFavorite: false,
    tags: ['문서요약', '다단계분석', '국정감사', '체계적분석', '핵심추출'],
  },

  {
    title: '핵심 쟁점 추출 도구',
    description: '방대한 자료 속에서 국정감사에 활용할 수 있는 핵심 쟁점과 질의 포인트를 자동으로 발굴하는 전문 도구',
    content: `# 핵심 쟁점 추출 도구

**역할**: 당신은 숨겨진 이슈를 발굴하는 탐사 전문가입니다. 방대한 자료에서 국정감사에 활용할 핵심 쟁점을 찾아내는 전문가입니다.

## 🎯 분석 대상 설정

**분석할 자료**: [문서 업로드 또는 내용 입력]

**분석 범위**:
- [ ] 단일 문서 내 쟁점 발굴
- [ ] 복수 문서 간 비교 분석  
- [ ] 시계열 변화 추이 분석
- [ ] 타 기관 자료와 교차 검증

**감사 관점**:
- [ ] 예산 집행의 적정성
- [ ] 정책 효과성
- [ ] 법령 준수 여부
- [ ] 행정 효율성
- [ ] 국민 서비스 품질

## 1단계: 기본 쟁점 스캐닝

### A. 자동 키워드 추출

**빈도 높은 핵심 키워드 (TOP 10)**
1. [키워드] - 언급 빈도: [N회]
2. [키워드] - 언급 빈도: [N회]
3. [키워드] - 언급 빈도: [N회]
...

**주목할 만한 특수 키워드**
- **급증/급감 관련**: [성장, 감소, 증가, 하락 등과 함께 언급되는 사항]
- **문제 관련**: [어려움, 한계, 부족, 문제, 개선 등과 함께 언급되는 사항]
- **예산 관련**: [예산, 비용, 지출, 절약, 효율 등과 함께 언급되는 사항]

### B. 의심스러운 표현 탐지

**🚨 주의 깊게 볼 표현들**
- "어려움이 있으나", "한계는 있지만", "미흡한 부분이 있으나"
- "검토 중", "추진 예정", "계획하고 있음"  
- "노력하고 있습니다", "최선을 다하고 있습니다"
- "외부 요인으로 인해", "예상치 못한 상황으로"

**📊 수치 관련 의심점**
- 이전 대비 급격한 변화가 있는 수치
- 목표 대비 현저한 차이가 나는 실적
- 다른 기관 자료와 상이한 수치
- 구체적 근거 없이 제시된 추상적 수치

## 2단계: 심화 쟁점 분석

### A. 카테고리별 쟁점 분류

**💰 예산/재정 쟁점**
- **과다 책정**: [예산이 과도하게 편성된 사업]
- **집행 저조**: [예산 대비 집행률이 낮은 분야]
- **효율성 문제**: [투입 대비 성과가 낮은 사업]
- **중복 투자**: [유사한 목적의 사업 중복]

**📈 성과/효과성 쟁점**
- **목표 미달성**: [당초 목표 대비 성과 부족]
- **부작용 발생**: [정책 추진 과정에서 발생한 문제점]
- **효과 검증 미흡**: [성과 측정 방식의 문제]
- **지속가능성 의문**: [장기적 효과에 대한 우려]

**⚖️ 법령/제도 쟁점**  
- **법령 위반 소지**: [관련 법규 준수 여부]
- **제도적 한계**: [현행 제도의 구조적 문제]
- **규정 미비**: [필요한 규정이나 기준 부족]
- **형평성 문제**: [공정성이나 형평성 관련 이슈]

**🏛️ 조직/관리 쟁점**
- **관리 체계 미흡**: [업무 추진 체계의 문제]
- **인력 부족/과다**: [적정 인력 운영 관련]
- **전문성 부족**: [업무 수행 역량 관련]
- **소통 부족**: [관련 기관 간 협조체계]

### B. 쟁점별 심각도 평가

| 쟁점 | 심각도 | 시급성 | 개선가능성 | 정치적 파급력 | 종합점수 |
|------|--------|--------|------------|---------------|----------|
| [쟁점1] | 상/중/하 | 상/중/하 | 상/중/하 | 상/중/하 | [점수] |
| [쟁점2] | 상/중/하 | 상/중/하 | 상/중/하 | 상/중/하 | [점수] |
| [쟁점3] | 상/중/하 | 상/중/하 | 상/중/하 | 상/중/하 | [점수] |

## 3단계: 질의 포인트 개발

### 🎯 TOP 5 핵심 쟁점

**1순위: [쟁점 제목]**
- **핵심 문제**: [구체적 문제 상황]
- **근거 자료**: [관련 페이지, 수치, 출처]
- **관련 법령**: [해당되는 법률이나 규정]
- **피해/영향**: [국민이나 사회에 미치는 영향]
- **책임 소재**: [관련 기관이나 담당자]
- **개선 방향**: [구체적 해결 방안]

**예상 질의 시나리오**:
- 도입 질문: "○○ 현황이 어떻게 되는지 말씀해 주시기 바랍니다."
- 핵심 질문: "그런데 자료를 보니 ○○한 문제가 있는데, 이에 대해 어떻게 생각하십니까?"
- 추궁 질문: "그렇다면 ○○에 대한 책임은 누구에게 있다고 보십니까?"
- 대안 질문: "앞으로 이런 문제가 재발하지 않으려면 어떤 조치가 필요할까요?"

### 🔄 예상 답변 및 재반박 전략

**"외부 요인" 핑계형 답변**
- 재반박: "그렇다면 외부 요인을 사전에 예측하고 대비하지 못한 것은 누구의 책임입니까?"

**"최선을 다했다" 변명형 답변**  
- 재반박: "최선을 다한 결과가 이 정도라면, 애초 계획 자체에 문제가 있었던 것 아닙니까?"

**"법적 근거 부족" 회피형 답변**
- 재반박: "법적 근거가 부족하다면 왜 관련 법령 정비를 하지 않았습니까?"

**"예산 부족" 해명형 답변**
- 재반박: "그렇다면 한정된 예산을 더 효율적으로 사용할 방안은 검토했습니까?"

## 4단계: 후속 조치 계획

### 🔍 추가 검증 필요 사항
- **팩트체크 항목**: [확인이 필요한 수치나 사실]
- **법령 검토 사항**: [관련 법규 해석이 필요한 부분]
- **전문가 자문**: [기술적 검토가 필요한 분야]

### 📎 추가 자료 요구 목록
1. **필수 자료**: [질의에 꼭 필요한 상세 자료]
2. **보완 자료**: [질의 보강을 위한 추가 정보]
3. **비교 자료**: [타 기관이나 해외 사례 비교용]

### 📊 언론 및 여론 대응
- **보도자료 포인트**: [언론 발표 시 강조할 내용]
- **여론 설득 논리**: [국민들이 이해하기 쉬운 설명]
- **정치적 효과**: [의정활동 성과로 부각할 부분]

---

**사용 가이드**:
1. 분석할 자료를 업로드하고 분석 범위와 관점을 설정하세요
2. AI가 4단계에 걸쳐 체계적으로 쟁점을 추출하고 분석합니다
3. 추출된 쟁점별로 우선순위와 질의 전략을 검토하세요
4. 예상 답변과 재반박 시나리오를 숙지하고 질의에 활용하세요`,
    category: 'analysis',
    usageHours: 0,
    isFavorite: false,
    tags: ['쟁점추출', '이슈발굴', '질의포인트', '국정감사', '문제점분석'],
  },

  {
    title: '출처 추적 요약 시스템',
    description: '요약 내용의 원문 출처를 자동으로 표기하여 팩트체크와 근거 확인이 용이한 신뢰성 높은 요약 도구',
    content: `# 출처 추적 요약 시스템

**역할**: 당신은 정확성과 신뢰성을 중시하는 분석 전문가입니다. 모든 요약 내용에 대해 정확한 출처를 표기하여 검증 가능한 요약문을 제작합니다.

## 📚 문서 등록 및 설정

**분석 대상 문서**: [문서 업로드 또는 내용 입력]

**문서 기본 정보**:
- **제목**: [문서명]
- **작성기관**: [발행 기관]
- **작성일자**: [날짜]
- **총 페이지**: [페이지 수]
- **문서 유형**: [보고서/답변서/자료집 등]

**출처 표기 방식 선택**:
- [ ] 페이지 번호 표기 (예: p.15)
- [ ] 섹션별 표기 (예: 제2장, 3절)
- [ ] 문단 번호 표기 (예: 2-3-1)
- [ ] 혼합 표기 (페이지+섹션)

**요약 목적**:
- [ ] 국정감사 질의서 작성
- [ ] 보고서 브리핑 자료
- [ ] 쟁점 분석 자료
- [ ] 팩트체크 검증 자료

## 1단계: 구조화된 요약 (출처 명시)

### 📋 문서 개요
**전체 내용 요약** (3-5문장)
[문서의 핵심 내용을 간략히 요약]
*출처: [전체 문서]*

### 🎯 주요 구성 요소

**1. 정책/사업 목적**
[정책의 목적과 배경]
*출처: p.[페이지번호] 또는 [해당 섹션]*

**2. 추진 내용**  
[주요 추진 사항]
*출처: p.[페이지번호] 또는 [해당 섹션]*

**3. 예산 규모**
[관련 예산 정보]
*출처: p.[페이지번호] 또는 [해당 섹션]*

**4. 성과 및 실적**
[달성 성과나 현재 진행 상황]
*출처: p.[페이지번호] 또는 [해당 섹션]*

## 2단계: 핵심 내용 상세 요약

### A. 주요 정책별 분석

**[정책명 1]** 
- **목적**: [정책 목표]
  *출처: p.[페이지번호]*
- **내용**: [구체적 추진 내용]
  *출처: p.[페이지번호]*  
- **예산**: [예산 규모와 집행 현황]
  *출처: p.[페이지번호]*
- **성과**: [측정된 성과나 지표]
  *출처: p.[페이지번호]*

**[정책명 2]**
[동일한 형식으로 출처 표기]

### B. 핵심 수치 및 통계

| 항목 | 수치 | 출처 | 비고 |
|------|------|------|------|
| [지표명] | [수치] | p.[페이지] | [특이사항] |
| [지표명] | [수치] | p.[페이지] | [특이사항] |
| [지표명] | [수치] | p.[페이지] | [특이사항] |

## 3단계: 문제점 및 쟁점 (근거 명시)

### 🚨 심각한 문제점

**1. [문제점 제목]**
- **문제 상황**: [구체적 문제 내용]
  *출처: p.[페이지번호], [정확한 문구 인용]*
- **관련 수치**: [수치적 근거]
  *출처: p.[페이지번호]*
- **법적 근거**: [관련 법령이나 규정]
  *출처: p.[페이지번호] 또는 [외부 법령]*

**2. [문제점 제목]**
[동일한 형식으로 출처 표기]

### ⚠️ 개선 필요 사항

**1. [개선 사항 제목]**
- **현재 상황**: [현황 설명]
  *출처: p.[페이지번호]*
- **문제점**: [무엇이 문제인지]
  *출처: p.[페이지번호]*
- **개선 방향**: [제시된 개선안이나 대안]
  *출처: p.[페이지번호]*

## 4단계: 질의 포인트 개발 (근거 자료 첨부)

### 🎯 핵심 질의 사항

**질의 1: [질의 제목]**
- **질의 배경**: [왜 이 질문을 하는지]
  *관련 출처: p.[페이지번호]*
- **핵심 질문**: "○○에 대해 ○○한 상황인데, 이에 대한 해명을 바랍니다."
- **근거 자료**: 
  - "문서 p.[페이지]에 따르면 '[정확한 인용구]'라고 되어 있는데..."
  - "같은 보고서 p.[페이지]에서는 '[또 다른 인용구]'라고 하고 있습니다."
- **예상 추가 질문**: [후속 질문 시나리오]

**질의 2: [질의 제목]**
[동일한 형식으로 구성]

**질의 3: [질의 제목]**  
[동일한 형식으로 구성]

## 5단계: 검증 및 교차 확인

### 🔍 팩트체크 체크리스트

**수치 검증**
- [ ] 모든 수치의 출처 확인: [확인 완료된 항목들]
- [ ] 계산 검증: [덧셈, 비율 등 계산 재확인]
- [ ] 시점 확인: [수치의 기준 시점 명시]

**인용문 검증**  
- [ ] 정확한 인용: [원문과 인용문 대조]
- [ ] 문맥 확인: [인용이 전체 맥락과 일치하는지]
- [ ] 해석 적정성: [인용문 해석이 과도하지 않은지]

**출처 표기 정확성**
- [ ] 페이지 번호 정확성: [모든 페이지 번호 재확인]
- [ ] 섹션 표기 정확성: [장, 절 표기 확인]
- [ ] 외부 자료 출처: [법령, 타 기관 자료 등]

### 📊 신뢰도 평가

| 구분 | 확인 항목 | 검증 결과 | 신뢰도 |
|------|-----------|-----------|--------|
| 주요 수치 | 출처 명시 여부 | ✓/✗ | 높음/중간/낮음 |
| 핵심 주장 | 근거 자료 존재 | ✓/✗ | 높음/중간/낮음 |
| 인용문 | 정확성 확인 | ✓/✗ | 높음/중간/낮음 |

## 6단계: 최종 검증 보고서

### 📋 요약 품질 보고

**출처 표기 현황**
- 총 [N]개의 출처 표기
- 페이지 번호 표기: [N]개
- 섹션 표기: [N]개  
- 외부 자료: [N]개

**검증 완료 사항**
- ✅ 모든 수치의 출처 확인
- ✅ 주요 인용문의 정확성 검증
- ✅ 페이지 번호 재확인
- ✅ 법령/규정 근거 확인

**주의사항**
- ⚠️ 추가 확인이 필요한 사항: [목록]
- ⚠️ 해석에 주의가 필요한 부분: [목록]
- ⚠️ 원문 대조가 권장되는 부분: [목록]

### 🔗 참고 자료 목록

**주요 출처**
1. [문서명] - p.[페이지 범위]
2. [관련 법령명] - [조항]
3. [타 기관 자료] - [출처 정보]

**검증용 추가 자료**
- [확인이 필요한 외부 자료 목록]
- [교차 검증 가능한 참고 문서]

---

## 🎛️ 사용자 설정 옵션

**출처 표기 세부 설정**:
- [ ] 페이지별 요약 (각 페이지마다 별도 요약)
- [ ] 주제별 요약 (주제별로 관련 출처 통합)
- [ ] 시간순 요약 (시간 흐름에 따른 출처 정리)

**검증 수준 선택**:
- [ ] 기본 검증: 출처 표기 및 페이지 확인
- [ ] 정밀 검증: 인용문 정확성까지 확인  
- [ ] 완전 검증: 모든 수치와 사실 관계 재확인

---

**사용 가이드**:
1. 문서를 업로드하고 출처 표기 방식을 선택하세요
2. AI가 모든 요약 내용에 정확한 출처를 표기합니다
3. 검증 체크리스트를 통해 신뢰도를 확인하세요
4. 질의서 작성 시 근거 자료로 출처 정보를 활용하세요
5. 중요한 사항은 반드시 원문을 직접 확인하세요`,
    category: 'analysis',
    usageHours: 0,
    isFavorite: false,
    tags: ['출처추적', '팩트체크', '검증시스템', '신뢰성', '근거자료'],
  },
];

// 데이터베이스에 프롬프트 추가하는 함수
async function addChapter2PromptsToDatabase() {
  console.log('🚀 Chapter 2 기반 프롬프트 추가 시작...');
  
  let successCount = 0;
  let failCount = 0;

  for (const prompt of CHAPTER2_PROMPTS) {
    try {
      await PromptService.createPrompt(prompt);
      console.log(`✅ 추가 완료: ${prompt.title}`);
      successCount++;
    } catch (error) {
      console.error(`❌ 추가 실패: ${prompt.title}`, error);
      failCount++;
    }
  }

  console.log(`\n📊 Chapter 2 추가 결과: 성공 ${successCount}개, 실패 ${failCount}개`);
  
  if (successCount > 0) {
    console.log('🎉 Chapter 2 기반 프롬프트가 성공적으로 추가되었습니다!');
  }
}

// 스크립트 실행
addChapter2PromptsToDatabase().catch(console.error);